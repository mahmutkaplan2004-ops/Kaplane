# مكتب القبلان - متجر إلكتروني

## نظرة عامة
تطبيق متجر إلكتروني بالعربية لـ"مكتب القبلان" مع نظام إدارة كامل للمندوبين ونظام طلبات للزبائن.

## الميزات الرئيسية

### نظام الدخول
- **زبون**: يدخل باسم الماركت فقط بدون رمز
- **مندوب**: يدخل باسم المندوب ورمز سري (20040104)

### الأقسام (5 أقسام)
1. العروضات - منتجات بسعرين (قديم مشطوب + جديد)
2. المشروبات
3. الحلويات
4. الذرة والجبس
5. السفريات

### وحدات البيع
- **كارتون**: السعر الكامل من المنتج
- **نصف كارتون**: نصف سعر الكارتون تلقائياً
- **باكيت**: للحلويات فقط، سعر منفصل

### سلة التسوق
- عرض مجدول للمنتجات
- حساب الإجمالي تلقائياً
- إزالة المنتجات
- حفظ وإرسال عبر واتساب (+9647706831028)
- حفظ كملف PDF (باستخدام مكتبة jsPDF لتوليد PDF حقيقي)

### لوحة إدارة المندوب
- إضافة منتج جديد
- تعديل منتج
- حذف منتج
- إضافة منتج للعروضات (سعر قديم + جديد)
- عرض جميع الطلبيات المحفوظة
- تشغيل/إيقاف الموقع للزبائن
- حفظ البيانات

### نظام العروضات الخاص
- المنتجات في قسم العروضات تظهر بسعرين:
  - السعر القديم: مشطوب
  - السعر الجديد: فعال (يُستخدم في البيع)
- يمكن للمندوب إضافة أي منتج للعروضات

## البنية التقنية

### Frontend
- React + TypeScript
- Tailwind CSS للتصميم
- Shadcn UI للمكونات
- TanStack Query لإدارة البيانات
- واجهة عربية كاملة RTL
- خط Cairo للنصوص العربية

### Backend
- Express.js
- PostgreSQL (قاعدة بيانات دائمة)
- Drizzle ORM
- نظام مصادقة بسيط للمندوبين

### قاعدة البيانات
- **categories**: الأقسام الخمسة
- **products**: المنتجات مع الأسعار
- **offers**: العروضات الخاصة
- **orders**: الطلبيات المحفوظة
- **orderItems**: تفاصيل كل طلبية
- **siteSettings**: حالة الموقع (مفعل/موقوف)

## نظام الأمان
- APIs الإدارية محمية بـ header مصادقة
- فقط المندوبون يمكنهم:
  - إضافة/تعديل/حذف المنتجات
  - إدارة العروضات
  - تغيير حالة الموقع
  - عرض الطلبيات

**ملاحظة أمنية:**
- هذا نظام مصادقة بسيط مناسب للاستخدام الداخلي
- الرمز السري الحالي: 20040104
- للاستخدام في بيئة إنتاج حقيقية، يُنصح بتطبيق:
  - نظام session-based authentication
  - تشفير الاتصالات (HTTPS)
  - تغيير الرمز السري بانتظام

## كيفية الاستخدام

### للزبائن
1. الدخول باسم الماركت
2. اختيار القسم
3. إضافة المنتجات للسلة (اختيار الوحدة والكمية)
4. حفظ وإرسال الطلبية عبر واتساب أو PDF

### للمندوبين
1. الدخول باسم المندوب + الرمز السري (20040104)
2. إدارة المنتجات (إضافة/تعديل/حذف)
3. إضافة منتجات للعروضات
4. عرض جميع الطلبيات
5. التحكم في تشغيل/إيقاف الموقع للزبائن

## التشغيل
```bash
npm run dev
```

## قاعدة البيانات
```bash
npm run db:push
```

## الملفات المهمة
- `/shared/schema.ts` - تعريفات قاعدة البيانات
- `/server/routes.ts` - نقاط API
- `/server/storage.ts` - منطق التخزين
- `/client/src/pages/Home.tsx` - الصفحة الرئيسية
- `/client/src/components/` - المكونات المستخدمة

## آخر التحديثات
- إضافة نظام مصادقة للمندوبين
- حماية APIs الإدارية (POST, PATCH, DELETE)
- حماية عرض الطلبيات (GET /api/orders - للمندوبين فقط)
- تحسين نظام حفظ الطلبيات
- إضافة صفحة عرض الطلبيات المحفوظة
- تطبيق PDF export حقيقي باستخدام jsPDF (يُنتج ملفات PDF فعلية بدلاً من نصية)
